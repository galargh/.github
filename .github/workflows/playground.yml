name: Playground

on:
  workflow_dispatch:
  pull_request:
  push:
    paths: ['.github/workflows/playground.yml']

defaults:
  run:
    shell: bash

jobs:
  playground:
    runs-on: windows-latest
    steps:
      - uses: galargh/setup-go@windows-hostedtoolcache
        with:
          go-version: stable
      - uses: actions/github-script@v6
        with:
          script: |
            const fs = require('fs')
            const path = require('path')
            const os = require('os')
            
            const toolPath = `${process.env.RUNNER_TOOL_CACHE}\\go`

            console.log(toolPath)

            const arch = os.arch()
            
            const versions = []
            if (fs.existsSync(toolPath)) {
              const children = fs.readdirSync(toolPath)
              for (const child of children) {
                const fullPath = path.join(toolPath, child, arch || '')
                console.log(fullPath, fs.existsSync(fullPath), fs.existsSync(`${fullPath}.complete`))
                if (fs.existsSync(fullPath) && fs.existsSync(`${fullPath}.complete`)) {
                  versions.push(child)
                }
              }
            }

            console.log(versions)
      - run: ls -a D:/hostedtoolcache/windows/go/1.21.0
      - run: ls -a C:/hostedtoolcache/windows/go/1.21.0
      - run: ls -a C:/hostedtoolcache/windows/go/1.20.7
